# -*- mode: python -*-
import sys
import os

import mem

def setup_paths(env):
    build_tools_path = os.path.join(mem.root, "build_tools", "lib", "python")
    sys.path.append(build_tools_path)

    try:
        os.makedirs(build_tools_path)
    except OSError:
        pass

    try:
        os.makedirs(env.BUILD_DIR)
    except OSError:
        pass


def build():

    env = mem.util.Env(c = mem.tasks.gcc,
                       CFLAGS = ["-O1", "-Wall", "-Wextra"],
                       BUILD_DIR = "mem_build")

    setup_paths(env)

    goodbye_o = mem.subdir("goodbye").build(env)
    env.c.prog("hello",
               objs = [env.c.obj(["main.c", "hello.c"], env=env),
                       goodbye_o],
               env=env)
