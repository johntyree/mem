<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.2.1" />
<style type="text/css">
/* Debug borders */
p, li, dt, dd, div, pre, h1, h2, h3, h4, h5, h6 {
/*
  border: 1px solid red;
*/
}

body {
  margin: 1em 5% 1em 5%;
  font-size: .8em;
  background: #f0fff0;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
  color: navy;
}

strong {
  font-weight: bold;
  color: #083194;
}

tt {
  color: navy;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  font-family: sans-serif;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}

div.sectionbody {
  font-family: serif;
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}

pre {
  padding: 0;
  margin: 0;
}

span#author {
  color: #527bbd;
  font-family: sans-serif;
  font-weight: bold;
  font-size: 1.1em;
}
span#email {
}
span#revision {
  font-family: sans-serif;
}

div#footer {
  font-family: sans-serif;
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
div#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
div#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

div#preamble,
div.tableblock, div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-right: 10%;
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.5em;
  margin-bottom: 2.5em;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #527bbd;
  font-family: sans-serif;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid silver;
  padding: 0.5em;
}

div.listingblock {
  margin-right: 0%;
}
div.listingblock > div.content {
  border: 1px solid silver;
  background: #f4f4f4;
  padding: 0.5em;
}

div.quoteblock > div.content {
  padding-left: 2.0em;
}

div.attribution {
  text-align: right;
}
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 2px solid silver;
}

div.exampleblock > div.content {
  border-left: 2px solid silver;
  padding: 0.5em;
}

div.verseblock div.content {
  white-space: pre;
}

div.imageblock div.content { padding-left: 0; }
div.imageblock img { border: 1px solid silver; }
span.image img { border-style: none; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
div.olist > ol {
  list-style-type: decimal;
}
div.olist2 > ol {
  list-style-type: lower-alpha;
}

div.tableblock > table {
  border: 3px solid #527bbd;
}
thead {
  font-family: sans-serif;
  font-weight: bold;
}
tfoot {
  font-weight: bold;
}

div.hlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hlist td {
  padding-bottom: 15px;
}
td.hlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
}
td.hlist2 {
  vertical-align: top;
}

@media print {
  div#footer-badges { display: none; }
}

div#toctitle {
  color: #527bbd;
  font-family: sans-serif;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}
/* Workarounds for IE6's broken and incomplete CSS2. */

div.sidebar-content {
  background: #ffffee;
  border: 1px solid silver;
  padding: 0.5em;
}
div.sidebar-title, div.image-title {
  color: #527bbd;
  font-family: sans-serif;
  font-weight: bold;
  margin-top: 0.0em;
  margin-bottom: 0.5em;
}

div.listingblock div.content {
  border: 1px solid silver;
  background: #f4f4f4;
  padding: 0.5em;
}

div.quoteblock-content {
  padding-left: 2.0em;
}

div.exampleblock-content {
  border-left: 2px solid silver;
  padding-left: 0.5em;
}

/* IE6 sets dynamically generated links as visited. */
div#toc a:visited { color: blue; }

/* Because IE6 child selector is broken. */
div.olist2 ol {
  list-style-type: lower-alpha;
}
div.olist2 div.olist ol {
  list-style-type: decimal;
}
</style>
<title>mem: getting started.</title>
</head>
<body>
<div id="header">
<h1><span class="image">
<img src="mem.png" alt="mem" title="mem" />
</span>: getting started.</h1>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="para"><p>[
  <a href="http://srp.github.com/mem">Home</a> |
  <a href="http://github.com/srp/mem/tree/master">Source</a> |
  <a href="http://groups.google.com/group/mem-users">Mailing list</a> |
  <a href="documentation.html">Documentation</a>
]</p></div>
</div>
</div>
<h2>Using mem with existing functions</h2>
<div class="sectionbody">
<div class="para"><p>While its easy to add new kinds of new memoized build functions, lets
start with some examples of using mem with the functions that it come
with.</p></div>
<h3>Hello, World</h3><div style="clear:left"></div>
<div class="para"><p>Either find the following files in the "examples/hello",
directory, or create a new directory and create these files:</p></div>
<div class="listingblock">
<div class="title">Example: examples/hello-1/hello.c</div>
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #000080">#include</span></span> <span style="color: #FF0000">&lt;stdio.h&gt;</span>

<span style="color: #009900">int</span>
<span style="font-weight: bold"><span style="color: #000000">main</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> argc<span style="color: #990000">,</span> <span style="color: #009900">char</span> <span style="color: #990000">**</span>argv<span style="color: #990000">)</span>
<span style="color: #FF0000">{</span>
        <span style="font-weight: bold"><span style="color: #000000">printf</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"Hello, World</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000">"</span><span style="color: #990000">);</span>
        <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="color: #993399">0</span><span style="color: #990000">;</span>
<span style="color: #FF0000">}</span>
</tt></pre></div></div>
<div class="listingblock">
<div class="title">Example: examples/hello-1/MemfileRoot</div>
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900"># -*- mode: python -*-</span></span>
<span style="font-weight: bold"><span style="color: #000080">import</span></span> mem

<span style="font-weight: bold"><span style="color: #0000FF">def</span></span> <span style="font-weight: bold"><span style="color: #000000">build</span></span><span style="color: #990000">():</span>
    hello_o <span style="color: #990000">=</span> mem<span style="color: #990000">.</span>tasks<span style="color: #990000">.</span>gcc<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">obj</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"hello.c"</span><span style="color: #990000">)</span>
    mem<span style="color: #990000">.</span>tasks<span style="color: #990000">.</span>gcc<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">prog</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"hello"</span><span style="color: #990000">,</span> hello_o<span style="color: #990000">)</span>
</tt></pre></div></div>
<div class="para"><p>When <em>mem</em> is ran, it looks up your directory hierarchy towards the
root directory for the first <em>MemfileRoot</em> it can find; it will import
it and then run the <em>build()</em> method on it. From here you can do
pretty much anything you like to script your build. In this case we
are calling two predefined build tasks: <em>gcc.obj()</em> and
<em>gcc.prog()</em>. The first one calls gcc to convert a <em>.c</em> file into a
<em>.o</em> file, the latter one links objects into a program.</p></div>
<div class="para"><p>Here's what it looks like to build:</p></div>
<div class="listingblock">
<div class="title">Example: Running mem</div>
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #990000">[</span><span style="color: #993399">0</span><span style="color: #990000">]~</span>/git/mem/examples/hello-<span style="color: #993399">1</span> <span style="color: #990000">[</span>master<span style="color: #990000">]</span>$ mem
gcc -M -o - /Users/srp/git/mem-src/examples/hello-<span style="color: #993399">1</span>/hello-<span style="color: #993399">1</span><span style="color: #990000">.</span>c
gcc -c -o /Users/srp/git/mem-src/examples/hello-<span style="color: #993399">1</span>/hello<span style="color: #990000">.</span>o /Users/srp/git/mem-src/examples/hello-<span style="color: #993399">1</span>/hello<span style="color: #990000">.</span>c
gcc -o /Users/srp/git/mem-src/examples/hello-<span style="color: #993399">1</span>/hello /Users/srp/git/mem-src/examples/hello-<span style="color: #993399">1</span>/hello<span style="color: #990000">.</span>o
<span style="color: #990000">[</span><span style="color: #993399">0</span><span style="color: #990000">]~</span>/git/mem/examples/hello-<span style="color: #993399">1</span> <span style="color: #990000">[</span>master<span style="color: #990000">]</span>$ <span style="color: #990000">.</span>/hello
Hello<span style="color: #990000">,</span> World
<span style="color: #990000">[</span><span style="color: #993399">0</span><span style="color: #990000">]~</span>/git/mem-src/examples/hello-<span style="color: #993399">1</span> <span style="color: #990000">[</span>master<span style="color: #990000">]</span>$
</tt></pre></div></div>
<div class="para"><p>If you're wondering about why <em>gcc</em> is called three times; <em>gcc.obj()</em>
actually does more then just create an object, it also calls <em>gcc -M</em>
(eg <em>make depends</em>) which instructs <em>gcc</em> to give a list of
dependencies of this file, such as all of the headers it ultimately
recursively uses.</p></div>
<div class="para"><p>The mem philosophy is that the end user shouldn't have to worry about
getting dependencies correct&#8212;the dependencies should be implicit in
the build commands themsevles. As such, most well created mem tasks
will automatically find their own dependencies.</p></div>
<h3>Restoration</h3><div style="clear:left"></div>
<div class="para"><p>The name "mem" comes from the fact that "memoization" is used as the
basis of building. Basically this just means that certain function
calls of the build are cached so that the work will not have to be
identically repeated. Obviously this has to include the file
system. To see this in action, let's repeat the build:</p></div>
<div class="listingblock">
<div class="title">Example: Running mem again</div>
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #990000">[</span><span style="color: #993399">0</span><span style="color: #990000">]~</span>/git/mem-src/examples/hello-<span style="color: #993399">1</span> <span style="color: #990000">[</span>master<span style="color: #990000">]</span>$ mem
<span style="color: #990000">[</span><span style="color: #993399">0</span><span style="color: #990000">]~</span>/git/mem-src/examples/hello-<span style="color: #993399">1</span> <span style="color: #990000">[</span>master<span style="color: #990000">]</span>$
</tt></pre></div></div>
<div class="para"><p>And even better, if we blow away or mame the files it produced and then rerun
it:</p></div>
<div class="listingblock">
<div class="title">Example: Running mem yet again</div>
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #990000">[</span><span style="color: #993399">0</span><span style="color: #990000">]~</span>/git/mem-src/examples/hello-<span style="color: #993399">1</span> <span style="color: #990000">[</span>master<span style="color: #990000">]</span>$ rm hello
<span style="color: #990000">[</span><span style="color: #993399">0</span><span style="color: #990000">]~</span>/git/mem-src/examples/hello-<span style="color: #993399">1</span> <span style="color: #990000">[</span>master<span style="color: #990000">]</span>$ echo <span style="color: #FF0000">"jab"</span> <span style="color: #990000">&gt;</span> hello<span style="color: #990000">.</span>o
<span style="color: #990000">[</span><span style="color: #993399">0</span><span style="color: #990000">]~</span>/git/mem-src/examples/hello-<span style="color: #993399">1</span> <span style="color: #990000">[</span>master<span style="color: #990000">]</span>$ mem
Restoring<span style="color: #990000">:</span> /Users/srp/git/mem-src/examples/hello-<span style="color: #993399">1</span>/hello<span style="color: #990000">.</span>o
Restoring<span style="color: #990000">:</span> /Users/srp/git/mem-src/examples/hello-<span style="color: #993399">1</span>/hello
<span style="color: #990000">[</span><span style="color: #993399">0</span><span style="color: #990000">]~</span>/git/mem-src/examples/hello-<span style="color: #993399">1</span> <span style="color: #990000">[</span>master<span style="color: #990000">]</span>$
</tt></pre></div></div>
<h3>Environments: configuration for build tasks</h3><div style="clear:left"></div>
<div class="para"><p>Likely you'll want to be able to control such things as which flags
get passed to your compiler. Environment(s) are usually used for
this. Most tasks will document which environment flags they look
for. For example, the <em>gcc</em> task looks for the <em>CFLAGS</em> variable;
here's our example with a few more flags added:</p></div>
<div class="listingblock">
<div class="title">Example: examples/hello-2/MemfileRoot</div>
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900"># -*- mode: python -*-</span></span>
<span style="font-weight: bold"><span style="color: #000080">import</span></span> mem

<span style="font-weight: bold"><span style="color: #0000FF">def</span></span> <span style="font-weight: bold"><span style="color: #000000">build</span></span><span style="color: #990000">():</span>
    env <span style="color: #990000">=</span> mem<span style="color: #990000">.</span>util<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">Env</span></span><span style="color: #990000">(</span>CFLAGS <span style="color: #990000">=</span> <span style="color: #990000">[</span><span style="color: #FF0000">"-Wall"</span><span style="color: #990000">,</span> <span style="color: #FF0000">"-Werror"</span><span style="color: #990000">,</span> <span style="color: #FF0000">"-O3"</span><span style="color: #990000">])</span>
    hello_o <span style="color: #990000">=</span> mem<span style="color: #990000">.</span>tasks<span style="color: #990000">.</span>gcc<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">obj</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"hello.c"</span><span style="color: #990000">,</span> env<span style="color: #990000">=</span>env<span style="color: #990000">)</span>
    mem<span style="color: #990000">.</span>tasks<span style="color: #990000">.</span>gcc<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">prog</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"hello"</span><span style="color: #990000">,</span> hello_o<span style="color: #990000">,</span> env<span style="color: #990000">=</span>env<span style="color: #990000">)</span>
</tt></pre></div></div>
<div class="para"><p>As you see, <em>CFLAGS</em> expects the flags to pass to gcc to be passed as
a list of strings; much the same way as the POSIX API <em>execve()</em> uses
an arrays of strings.</p></div>
<div class="listingblock">
<div class="title">Example: Running mem</div>
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #990000">[</span><span style="color: #993399">0</span><span style="color: #990000">]~</span>/git/mem-src/examples/hello-<span style="color: #993399">2</span> <span style="color: #990000">[</span>master<span style="color: #990000">]</span>$ mem
gcc -Wall -Werror -O<span style="color: #993399">3</span> -M -o - /Users/srp/git/mem-src/examples/hello-<span style="color: #993399">2</span>/hello<span style="color: #990000">.</span>c
gcc -Wall -Werror -O<span style="color: #993399">3</span> -c -o /Users/srp/git/mem-src/examples/hello-<span style="color: #993399">2</span>/hello<span style="color: #990000">.</span>o /Users/srp/git/mem-src/examples/hello-<span style="color: #993399">2</span>/hello<span style="color: #990000">.</span>c
gcc -o /Users/srp/git/mem-src/examples/hello-<span style="color: #993399">2</span>/hello -Wall -Werror -O<span style="color: #993399">3</span> /Users/srp/git/mem-src/examples/hello-<span style="color: #993399">2</span>/hello<span style="color: #990000">.</span>o
<span style="color: #990000">[</span><span style="color: #993399">0</span><span style="color: #990000">]~</span>/git/mem-src/examples/hello-<span style="color: #993399">2</span> <span style="color: #990000">[</span>master<span style="color: #990000">]</span>$
</tt></pre></div></div>
<h3>More on restoration</h3><div style="clear:left"></div>
<div class="para"><p>Earlier we saw how mem will restore target files that got removed or
changed; it also remembers how to do this across changed builds. For
example, if we edit the <em>MemfileRoot</em> to have "-O2 -g" instead of
"-O3" and rebuild we should see something like the following, as we'd
expect:</p></div>
<div class="listingblock">
<div class="title">Example: Running mem with "-O2 -g"</div>
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #990000">[</span><span style="color: #993399">0</span><span style="color: #990000">]~</span>/git/mem-src/examples/hello-<span style="color: #993399">2</span> <span style="color: #990000">[</span>master<span style="color: #990000">]</span>$ mem
gcc -Wall -Werror -O<span style="color: #993399">2</span> -M -o - /Users/srp/git/mem-src/examples/hello-<span style="color: #993399">2</span>/hello<span style="color: #990000">.</span>c
gcc -Wall -Werror -O<span style="color: #993399">2</span> -c -o /Users/srp/git/mem-src/examples/hello-<span style="color: #993399">2</span>/hello<span style="color: #990000">.</span>o /Users/srp/git/mem-src/examples/hello-<span style="color: #993399">2</span>/hello<span style="color: #990000">.</span>c
gcc -o /Users/srp/git/mem-src/examples/hello-<span style="color: #993399">2</span>/hello -Wall -Werror -O<span style="color: #993399">2</span> /Users/srp/git/mem-src/examples/hello-<span style="color: #993399">2</span>/hello<span style="color: #990000">.</span>o
<span style="color: #990000">[</span><span style="color: #993399">0</span><span style="color: #990000">]~</span>/git/mem-src/examples/hello-<span style="color: #993399">2</span> <span style="color: #990000">[</span>master<span style="color: #990000">]</span>$
</tt></pre></div></div>
<div class="para"><p>However, if we change the flag back to -O3 we'll observe:</p></div>
<div class="listingblock">
<div class="title">Example: Running mem with -O3 again</div>
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #990000">[</span><span style="color: #993399">0</span><span style="color: #990000">]~</span>/git/mem-src/examples/hello-<span style="color: #993399">2</span> <span style="color: #990000">[</span>master<span style="color: #990000">]</span>$ mem
<span style="color: #990000">[</span><span style="color: #993399">0</span><span style="color: #990000">]~</span>/git/mem-src/examples/hello-<span style="color: #993399">2</span> <span style="color: #990000">[</span>master<span style="color: #990000">]</span>$
</tt></pre></div></div>
<div class="para"><p>What's going on?</p></div>
<div class="para"><p>Two things: first mem remembers previous builds, so it remembered the
build with "-O3" and would normally just restore that without having
to do any recompiling (as long as nothing else changes); the second
thing is that in this simple case, gcc produces the same thing for
"-O2" as "-O3" and mem effectively notices that nothing needs to be
restored when we return to "-O3", as all of the target files are
already as they should be.</p></div>
<h3>Per function configuration</h3><div style="clear:left"></div>
<div class="para"><p>Environment variables can also be overriden on a per function call
basis:</p></div>
<div class="listingblock">
<div class="title">Example: examples/hello-3/MemfileRoot</div>
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900"># -*- mode: python -*-</span></span>
<span style="font-weight: bold"><span style="color: #000080">import</span></span> mem

<span style="font-weight: bold"><span style="color: #0000FF">def</span></span> <span style="font-weight: bold"><span style="color: #000000">build</span></span><span style="color: #990000">():</span>
    env <span style="color: #990000">=</span> mem<span style="color: #990000">.</span>util<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">Env</span></span><span style="color: #990000">(</span>CFLAGS <span style="color: #990000">=</span> <span style="color: #990000">[</span><span style="color: #FF0000">"-Wall"</span><span style="color: #990000">,</span> <span style="color: #FF0000">"-Werror"</span><span style="color: #990000">,</span> <span style="color: #FF0000">"-O3"</span><span style="color: #990000">])</span>
    hello_o <span style="color: #990000">=</span> mem<span style="color: #990000">.</span>tasks<span style="color: #990000">.</span>gcc<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">obj</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"hello.c"</span><span style="color: #990000">,</span> CFLAGS<span style="color: #990000">=[</span><span style="color: #FF0000">"-Wall"</span><span style="color: #990000">,</span> <span style="color: #FF0000">"-g"</span><span style="color: #990000">],</span> env<span style="color: #990000">=</span>env<span style="color: #990000">)</span>
    mem<span style="color: #990000">.</span>tasks<span style="color: #990000">.</span>gcc<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">prog</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"hello"</span><span style="color: #990000">,</span> hello_o<span style="color: #990000">,</span> env<span style="color: #990000">=</span>env<span style="color: #990000">)</span>
</tt></pre></div></div>
<div class="listingblock">
<div class="title">Example: Running mem</div>
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #990000">[</span><span style="color: #993399">0</span><span style="color: #990000">]~</span>/git/mem-src/examples/hello-<span style="color: #993399">3</span> <span style="color: #990000">[</span>master<span style="color: #990000">]</span>$ mem
gcc -Wall -g -M -o - /Users/srp/git/mem-src/examples/hello-<span style="color: #993399">3</span>/hello<span style="color: #990000">.</span>c
gcc -Wall -g -c -o /Users/srp/git/mem-src/examples/hello-<span style="color: #993399">3</span>/hello<span style="color: #990000">.</span>o /Users/srp/git/mem-src/examples/hello-<span style="color: #993399">3</span>/hello<span style="color: #990000">.</span>c
gcc -o /Users/srp/git/mem-src/examples/hello-<span style="color: #993399">3</span>/hello -Wall -Werror -O<span style="color: #993399">3</span> /Users/srp/git/mem-src/examples/hello-<span style="color: #993399">3</span>/hello<span style="color: #990000">.</span>o
</tt></pre></div></div>
<h3>Build Directories</h3><div style="clear:left"></div>
<div class="para"><p>Many find it in poor taste to build directly in the source directory;
mem easily allows for placing built files in a separate
directory. This can be done by setting the <em>BUILD_DIR</em> environment
variable:</p></div>
<div class="listingblock">
<div class="title">Example: examples/hello-4/MemfileRoot</div>
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900"># -*- mode: python -*-</span></span>
<span style="font-weight: bold"><span style="color: #000080">import</span></span> mem

<span style="font-weight: bold"><span style="color: #0000FF">def</span></span> <span style="font-weight: bold"><span style="color: #000000">build</span></span><span style="color: #990000">():</span>
    env <span style="color: #990000">=</span> mem<span style="color: #990000">.</span>util<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">Env</span></span><span style="color: #990000">(</span>CFLAGS <span style="color: #990000">=</span> <span style="color: #990000">[</span><span style="color: #FF0000">"-Wall"</span><span style="color: #990000">,</span> <span style="color: #FF0000">"-Werror"</span><span style="color: #990000">,</span> <span style="color: #FF0000">"-O3"</span><span style="color: #990000">],</span>
                       BUILD_DIR <span style="color: #990000">=</span> <span style="color: #FF0000">"build"</span><span style="color: #990000">)</span>
    hello_o <span style="color: #990000">=</span> mem<span style="color: #990000">.</span>tasks<span style="color: #990000">.</span>gcc<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">obj</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"hello.c"</span><span style="color: #990000">,</span> env<span style="color: #990000">=</span>env<span style="color: #990000">)</span>
    mem<span style="color: #990000">.</span>tasks<span style="color: #990000">.</span>gcc<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">prog</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"hello"</span><span style="color: #990000">,</span> hello_o<span style="color: #990000">,</span> env<span style="color: #990000">=</span>env<span style="color: #990000">)</span>
</tt></pre></div></div>
<div class="listingblock">
<div class="title">Example: Running mem</div>
<div class="content"><!-- Generator: GNU source-highlight 2.11
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #990000">[</span><span style="color: #993399">0</span><span style="color: #990000">]~</span>/git/mem-src/examples/hello-<span style="color: #993399">4</span> <span style="color: #990000">[</span>master<span style="color: #990000">]</span>$ mem
gcc -Wall -Werror -O<span style="color: #993399">3</span> -I/Users/srp/git/mem-src/examples/hello-<span style="color: #993399">4</span>/build -M -o - /Users/srp/git/mem-src/examples/hello-<span style="color: #993399">4</span>/hello<span style="color: #990000">.</span>c
gcc -Wall -Werror -O<span style="color: #993399">3</span> -I/Users/srp/git/mem-src/examples/hello-<span style="color: #993399">4</span>/build -c -o /Users/srp/git/mem-src/examples/hello-<span style="color: #993399">4</span>/build/hello<span style="color: #990000">.</span>o /Users/srp/git/mem-src/examples/hello-<span style="color: #993399">4</span>/hello<span style="color: #990000">.</span>c
gcc -o /Users/srp/git/mem-src/examples/hello-<span style="color: #993399">4</span>/build/hello -Wall -Werror -O<span style="color: #993399">3</span> /Users/srp/git/mem-src/examples/hello-<span style="color: #993399">4</span>/build/hello<span style="color: #990000">.</span>o
<span style="color: #990000">[</span><span style="color: #993399">0</span><span style="color: #990000">]~</span>/git/mem-src/examples/hello-<span style="color: #993399">4</span> <span style="color: #990000">[</span>master<span style="color: #990000">]</span>$
</tt></pre></div></div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 14-Feb-2009 08:34:38 CDT
</div>
</div>
</body>
</html>
